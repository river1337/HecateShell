# QuickShell Development Notes

## Current Status
Custom shell for Arch Linux + Niri (Wayland) built with QuickShell/QML.

### Completed Features âœ…
- [x] Basic bar with proper anchoring (left/center/right sections)
- [x] Workspace indicator with sliding animation
- [x] Active workspace text fading to darker color
- [x] PipeWire/wpctl audio control with volume clamping (0-100%)
- [x] Click to toggle volume between 0% and previous level
- [x] Scroll to adjust volume
- [x] Volume mute icon when at 0%
- [x] Network status indicator (ping-based)
- [x] Date/Time widgets with live updates
- [x] Real-time audio visualizer using cava
  - Frequency spectrum: lows (left) â†’ mids (center) â†’ highs (right)
  - Bars grow upward from bottom
- [x] Matugen color integration
  - Template: `~/.config/matugen/templates/quickshell.conf`
  - Output: `~/.config/quickshell/config/colors.conf`
  - Hot-reload: Colors update automatically within 1 second
- [x] Smooth color transitions (200ms) on all widgets
- [x] Rounded background for center widgets (date/visualizer/time)
- [x] Modular directory structure:
  ```
  ~/.config/quickshell/
  â”œâ”€â”€ shell.qml           # Main entry point
  â”œâ”€â”€ qmldir              # Module definitions
  â”œâ”€â”€ theme.json          # Source color palette
  â”œâ”€â”€ bar/
  â”‚   â””â”€â”€ Bar.qml
  â”œâ”€â”€ components/
  â”‚   â”œâ”€â”€ Workspaces.qml
  â”‚   â”œâ”€â”€ DateWidget.qml
  â”‚   â”œâ”€â”€ TimeWidget.qml
  â”‚   â”œâ”€â”€ MusicVisualizer.qml
  â”‚   â””â”€â”€ SystemWidgets.qml
  â””â”€â”€ config/
      â”œâ”€â”€ Config.qml      # Singleton config with hot-reload
      â”œâ”€â”€ colors.conf     # Generated by matugen
      â”œâ”€â”€ theme.conf      # Additional config (not used yet)
      â””â”€â”€ cava.conf       # Cava visualizer config
  ```

## Active TODO List

### High Priority ðŸ”´
- [ ] **Create shell management binary** (Rust/Go?)
  - IPC for shell control (reload, theme switching, etc.)
  - Theme management commands (`quickshell theme switch <name>`)
  - Wallpaper integration with auto color generation
  - Matugen wrapper (`quickshell theme generate [image|color]`)
  - Shell reload/restart command
  - Status queries
  - Future: notification daemon integration?

### Medium Priority ðŸŸ¡
- [ ] App launcher/finder widget
- [ ] Notification widget/system
- [ ] Settings menu
- [ ] Wallpaper selector/manager

### Low Priority ðŸŸ¢
- [ ] Music player controls (MPRIS integration)
- [ ] Battery indicator (for laptops)
- [ ] Bluetooth widget
- [ ] System tray support?

### Future Ideas ðŸ’¡
- [ ] Multiple bar configurations (top/bottom, different layouts)
- [ ] Workspace-specific theming
- [ ] Custom widget API for easy additions
- [ ] Profile/preset system for quick theme switching
- [ ] Screenshot integration with color extraction

## Technical Notes

### Matugen Workflow
```bash
# Generate colors from theme.json
matugen json ~/.config/quickshell/theme.json -m dark --continue-on-error

# Generate from wallpaper
matugen image ~/wallpaper.png -m dark --continue-on-error

# Generate from color
matugen color '#D5C4AA' -m dark --continue-on-error
```

Note: `--continue-on-error` needed because other templates (rofi, micro, etc.) expect Material Design color names

### Config Files
- `theme.json` - Source color palette (keep this!)
- `colors.conf` - Auto-generated by matugen (hot-reloads)
- `Config.qml` - Reads colors.conf every 1 second, updates shell automatically

### Color Mapping (matugen template)
```
barBackground â†’ surface
backgroundColor â†’ background
backgroundColorAlt â†’ surfaceContainer
borderColor â†’ outline
textColor â†’ surfaceText
textColorDim â†’ surfaceVariantText
accentColor â†’ primary
workspaceActive â†’ primary
workspaceInactive â†’ surfaceContainerHigh
visualizerColor â†’ primary
```

## Known Issues / Quirks
- QuickShell built against Qt 6.10.0 but system has Qt 6.10.1 (rebuild needed)
- Cava frequency range: 50 Hz - 10 kHz (can adjust in config/cava.conf)
- Timer-based hot-reload checks file every 1 second (could use inotify in future binary)

## Dependencies
- quickshell (Qt 6.10+)
- quickshell-git (for niri support)
- cava (audio visualizer)
- pipewire + wireplumber (audio control)
- matugen (color generation)
- niri (Wayland compositor)

## Inspiration & References
- Material Design 3 color system
- Catppuccin Mocha (original placeholder colors)
- AGS (Aylur's Gtk Shell) - similar concept
- Eww (ElKowars wacky widgets)

---

*Last updated: 2025-12-19*
*Shell version: 0.1-alpha (lol)*
